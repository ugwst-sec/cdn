!function(e){var t="mini-preview";e.fn.miniPreview=function(i){return this.each(function(){var n=e(this),a=n.data(t);a&&a.destroy(),(a=new s(n,i)).generate(),n.data(t,a)})};var s=function(i,n){this.$el=i,this.$el.addClass(t+"-anchor"),this.options=e.extend({},this.defaultOptions,n),this.counter=s.prototype.sharedCounter++};s.prototype={sharedCounter:0,defaultOptions:{width:256,height:144,scale:.25,prefetch:"pageload"},generate:function(){this.createElements(),this.setPrefetch()},createElements:function(){var s=e("<div>",{class:t+"-wrapper"}),i=e("<div>",{class:t+"-loading"}),n=e("<iframe>",{class:t+"-frame"}),a=e("<div>",{class:t+"-cover"});s.appendTo(this.$el).append(i,n,a),s.css({width:this.options.width+"px",height:this.options.height+"px"});var o=100/this.options.scale;n.css({width:o+"%",height:o+"%",transform:"scale("+this.options.scale+")"});var r=parseInt(this.$el.css("font-size").replace("px",""),10),h=(this.$el.height()+r)/2,c=(this.$el.width()-s.outerWidth())/2;s.css({top:h+"px",left:c+"px"})},setPrefetch:function(){switch(this.options.prefetch){case"pageload":this.loadPreview();break;case"parenthover":this.$el.parent().one(this.getNamespacedEvent("mouseenter"),this.loadPreview.bind(this));break;case"none":this.$el.one(this.getNamespacedEvent("mouseenter"),this.loadPreview.bind(this));break;default:throw"Prefetch setting not recognized: "+this.options.prefetch}},loadPreview:function(){this.$el.find("."+t+"-frame").attr("src",this.$el.attr("href")).on("load",function(){e(this).css("background-color","#fff")})},getNamespacedEvent:function(e){return e+"."+t+"_"+this.counter},destroy:function(){this.$el.removeClass(t+"-anchor"),this.$el.parent().off(this.getNamespacedEvent("mouseenter")),this.$el.off(this.getNamespacedEvent("mouseenter")),this.$el.find("."+t+"-wrapper").remove()}}}(jQuery);